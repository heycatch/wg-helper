# WG-HELPER

## Мотивация
Надоело руками добавлять пользователей в конфигурацию wireguard.

Решил автоматизировать эти процессы, чтобы получать только готовый файл для пользователя. Популярные решения через докер меня не интересуют, да и веб-гуи мне не нужны. Поэтому было принято волевое решение пердолиться над собственной реализацией, желательно без зависимостей на стороне сервера, запустил бинарник и сразу используешь.

## Сборка
```bash
# Собираем из исходников или качаем бинарь со страницы с релизом.
dub build
# После переносим в удобное место на сервере, для меня это /usr/bin/.
```

## Первоначальная настройка впс на базе Debian
```bash
# Обновляем и устанавливаем нужные пакеты.
apt update && apt upgrade -y
apt install wireguard ufw curl

# Раскомментировать строчку net.ipv4.ip_forward = 1 в /etc/sysctl.conf и проверить.
sysctl -p

# Wg работает только по udp. Открываем нужный порт указанный в конфиге.
# 22 нужен для ssh.
ufw enable
ufw allow 22/tcp
ufw allow 1337/udp
ufw status # проверить все порты.

# Создаем конфиг для сервера wireguard(имя wg0 можно заменить на любое свое).
wghelper server wg0
# Запускаем сервис.
systemctl enable wg-quick@wg0
systemctl start wg-quick@wg0
systemctl status wg-quick@wg0 # Проверить сервис.

# Создаем конфиг для пользователя(имя bob можно заменить на любое свое). Утилита предложить перезапустить сервис, тут мы соглашаемся, иначе новый конфиг не будет работать.
wghelper client bob
# Конфиг сохраняется в папке /tmp/. Заходим туда и перемещаем его на компьютер. Настраиваем у себя, проверяем, ну а после можно посмотреть статистику командой ниже.

# Посмотреть запущенные интерфейсы.
wg
# Или... будет без разницы.
wg show
```
